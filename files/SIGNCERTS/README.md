# jabberPy

## What
1. Authorization code grant flow
2. Implicit Grant flow
3. RedirectUri Check
4. Negative tests (24)
5. Remote token verification
6. Scope check (3 users ith diff MRA policies, validate the scopes in the token)
7. Redirect uri tests
8. SAML SSO + OAuth Sanity
9. Authorize Proxy + Redirect URI

## How
1. Parameters that drive the test are in test/test.confi
2. Simply run test_manager.py
3. Logs will be avaialble at jabberPy.log

## Example
1. Install requirements:
```
root@sj-vm20-18:~/jabberPy# pip install -r  requirements.txt 
```
2. Run the test:
```
root@sj-vm20-18:~/jabberPy# python3 ./test_manager.py 
2020-11-24 19:17:06,217 - __main__ - INFO - Authorization code grant flow test passed
2020-11-24 19:17:06,617 - __main__ - INFO - Implicit grant flow test passed
2020-11-24 19:17:06,665 - __main__ - INFO - Check redirect uri passed
2020-11-24 19:17:08,323 - __main__ - INFO - Negative tests passed
2020-11-24 19:17:08,654 - __main__ - INFO - Remote token verification test passed
2020-11-24 19:17:34,588 - __main__ - INFO - Scopes check test passed
```
3. View/Extract logs:
```
2020-11-24 19:17:01,968 - utils.utility - INFO - Test config: {"tests": ["authCode", "implicitGrant", "redirectUriCheck", "negative_tests", "remote_token_verification", "scopes_check"], "server": "10.195.20.23", "username": "admin", "password": "ipcbu@123", "endUser": "neo0", "endUserPassword": "Cisco@123", "add_user": true}
2020-11-24 19:17:05,049 - utils.utility - DEBUG - Test Setup: User neo0 added successfully
2020-11-24 19:17:05,050 - utils.authorization_code - DEBUG - Test : Authorization Grant flow Start
2020-11-24 19:17:05,101 - utils.utility - DEBUG - b'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SSOResult><ErrorCode>0</ErrorCode><Response><SingleSignOn version="12.5.1.13900-152"><Status enabled="false"/><Token reuse="false"/><Uri>https://sj-vm20-23.cisco.com:8443/ssosp/oauth/authorize</Uri><allowEmbeddedSafari>false</allowEmbeddedSafari></SingleSignOn></Response></SSOResult>'
2020-11-24 19:17:05,250 - utils.authorization_code - DEBUG - Authorization Code: MjRiOWExNDgtYjAyOC00NzYyLTg0NzQtMjk3NGM1NDRlYThk
2020-11-24 19:17:05,448 - utils.authorization_code - DEBUG - Access token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjhhNTVhNmRkLTIwNmUtNDk1ZC1hMWYzLTMyNWVlMTQxYjRmYjoyZTcxZmJjODdlMjBjZGE0YjMwNGM2NzUwMzM3NWNkNDZjZWM4OTFjMTgwMDZlYzJkNzQ5OWJhNWZiMGViNmRiIn0.eyJwcml2YXRlIjoiZXlKaGJHY2lPaUprYVhJaUxDSmpkSGtpT2lKS1YxUWlMQ0psYm1NaU9pSkJNVEk0UTBKRExVaFRNalUySWl3aWEybGtJam9pT0dFMU5XRTJaR1F0TWpBMlpTMDBPVFZrTFdFeFpqTXRNekkxWldVeE5ERmlOR1ppT2pVNE9EYzNNbUpoTlRNd01XTm1aREptWXpabE1qYzJObVF6WmpoalpqbG1PR1kwWTJKaE1qRTNOVFUxWkROaU9UVm1PVFF6TXpnME4ySXhNekpsTkRraWZRLi54U2x4dTJVblhWMkI2VDJUR016NmFnLldXRnJ0QVlyeVhzQVRzZkhTWGJVcm82cW9KWHVwNGtRT3BkZ2JzcU95ZXlJdnNaVEE3c3o2YjJhbnJpSXRxQ2EzTUFDZml2TkNXLWdUMF92eEhzRy1La05DczdOM1hlY1NkcDllMGFxczMtUkctOGJPMUJhMERpQkplODdZbEVpT0VYSFVEblViT1NzLTJISndpRnlSQU9pcWZGTE9QaG5SS1NPeWZidy1URW9faWlybDRrYk15TXhPeWtmT2doY0VkdGNkeG9TYUFMZHRHOWItUElNa3pnUWo2QXp2Z1U1ZmRGbWYxZ2tLOVdiOXZfOVdTN1BtS3lqNC12X1N1dXNPQ2pRcmtfUzJCZUJPd0ZibEUxUTdOSzZzRE9iWnR4TXBGMVFuV012VkZLZXVjNXJOQk5XYm45TndiVmFZNnJZWVUyX2NpX3ZmbkQ1WFZSTEpNZ2lFTFpHQ2xwcjRCRkU0UzVWREh1QUFTT2pEakh5NUVYQk9kcFVxMVFQemNZNDVIdkxnSnRhNUxGYXc1dGZwWllhUjhocTVfZlZWRExFY0ptODlSb0w4QllKMVp0akhhZGZRdlJBR0NRS2M4VENLdV9JTHhKdDhDaFBTRndEeDhELUpXanFKUG1ZcEVBbWdYVHVraVlja3UtTHp3eG9ISXotTXd6cWJIaVhEeUVDZEV1Z1IxcEdaUzJDNjZKaDVhUXJjYUFOOXdYSGlxWEhBbTNRSTRhcVJfa0RQVXYyczFmdmYybmR3OVc3ZGtQU3RCbWtlaVBWYmtGNXBNbHRLQVpSamtOTFRJcmVEZERUQlFDeVdFRW1FeUdsSk5Bb1VPb19rRDE4aERsZ0pHQXBKWmh6endQYl9zUWVITkxIU0NjcXRoS3J3NGRSSnZESDcyem56dWwxTl9JbEhkZGdNVUlvcXV0Y2lJOVFfVThFTktmbnRPc0FwNkhoRmpyTG50Z0pWVzRmRDlreDE0Y0J2SVBxRXZKX1I3Q3ZNYWg1WkNIV21UNnFLaUZhbFNjdkVQSERaTEtMVDBqZmhKZzljOXJrZzNFTTdlZ1VwZHA1ZHl3ZDhuVTk0Y2ppRGxud1M3Rzg2ZWhia0JwUkM2ZFkuVXA1cWhOS1N0NnU0dU5OeGV4MGtmUSJ9.Y_2LzAuV05aI1lQNC3FfyTo-ciPjWKBmH5-zB3LMZ6fnNKx_ijy8Gni8IM6Yj1w88Jv_zmQkoqpC6GRf4vz1Y0ZuYqIyMBHpgqKD6xF3i7Bz85SPMsj8TkKF4oBisLL6yv6IBqsx2kiYuMqOEQ9uFtMf2Ad1Pa2BhgmYYCj-G7QALnW7mx2ulIcyyRYBH_U2K8oqqyI8kUsMOskyXIAmZ_I8UlwmSCRlYkwDEuiIrTmR3naD2OqstBMefPxNJgiooUsUHuKYymjO16rBo482iyriJ0xUZ7SpmdvjFCuOCuVdzShm8jRJLUBUVxGKBcVInRpMlAljTqd7Svl5mZjsmg
2020-11-24 19:17:05,448 - utils.authorization_code - DEBUG - Refresh token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjhhNTVhNmRkLTIwNmUtNDk1ZC1hMWYzLTMyNWVlMTQxYjRmYjoyZTcxZmJjODdlMjBjZGE0YjMwNGM2NzUwMzM3NWNkNDZjZWM4OTFjMTgwMDZlYzJkNzQ5OWJhNWZiMGViNmRiIn0.eyJleHAiOjE2MTE0OTc1NTMsImlzcyI6IjhhNTVhNmRkLTIwNmUtNDk1ZC1hMWYzLTMyNWVlMTQxYjRmYiIsInR5cCI6InVzZXIiLCJ0aWQiOiJhMzRkOWZhMS03NDMwLTQ3YzgtOTMxMS01ZGJmZDdiNDczMmEiLCJjdHlwIjoicmVmcmVzaCIsImNjaWQiOiJDM2IwYWZmZWZlMTQzOTA0MTY4M2U5YzJjMzdkMzZmNDM4ZWYwZWYyN2MwOTM4YWRjNjIyNmUwYzAzZDE2OWYyYSJ9.QmYVWfIQfhiCMkcsakt1flPSgWkIS1Pr10TKickugOLdQYf-bK5UzU5LTf-P9G_RBult1rUSZWWGsEvIAtqsA3PEIB7lmhT2pbI-m1HflZDL0tYwYEcEuRm11HgtoUlCg7TC8-kWvE9cpga8Ks4vOWJoURa8ZfY8ktX4xUYfyssQ6WyB5WQoLbVGnUEE4JHyv7kvdnPdvO6i3fwE8l7cswf-jCKph8b3f41G4z1YTKkZ5fjNwDvIYNCRJ-HbxFB7kRQ8-AHy_V60buBf-Jod-uxz7ThuZT-eO0WL5qVNPEgEpWqqbBYyuDyjO4jpK7fim21i9g2stKuT1klHQmnXwg
2020-11-24 19:17:05,643 - utils.utility - DEBUG - b'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><user uri="https://10.195.20.23:8443/cucm-uds/user/neo0" version="12.5.1"><id>a449d5c6-b39a-b4cc-e102-688adea4381a</id><userName>neo0</userName><firstName>OAuth</firstName><lastName>Sanity</lastName><middleName></middleName><nickName></nickName><displayName></displayName><emMaxLoginTime></emMaxLoginTime><allowProvisionEMMaxLoginTime>false</allowProvisionEMMaxLoginTime><phoneNumber></phoneNumber><homeNumber></homeNumber><mobileNumber></mobileNumber><mobileConnect>false</mobileConnect><remoteDestinationLimit>4</remoteDestinationLimit><userLocale uri="https://10.195.20.23:8443/cucm-uds/options/installedLocales" value="" appliesToAllDevices="true">English, United States</userLocale><email></email><directoryUri></directoryUri><msUri></msUri><department></department><manager></manager><title></title><pager></pager><selfServiceId></selfServiceId><accountType>local</accountType><homeCluster enableImAndPresence="false" enableCalendarPresence="false">true</homeCluster><imAndPresence/><enableDoNotDisturb appliesToAllDevices="true">false</enableDoNotDisturb><serviceProfile/><jabberProfile/><devices uri="https://10.195.20.23:8443/cucm-uds/user/neo0/devices"/><credentials uri="https://10.195.20.23:8443/cucm-uds/user/neo0/credentials"/><extensions uri="https://10.195.20.23:8443/cucm-uds/user/neo0/extensions"/><subscribedServices uri="https://10.195.20.23:8443/cucm-uds/user/neo0/subscribedServices"/><speedDials uri="https://10.195.20.23:8443/cucm-uds/user/neo0/speedDials"/></user>'
2020-11-24 19:17:05,783 - utils.utility - DEBUG - b'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><devices uri="https://10.195.20.23:8443/cucm-uds/user/neo0/devices" version="12.5.1"/>'
2020-11-24 19:17:06,067 - utils.utility - DEBUG - b'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><user uri="https://10.195.20.23:8443/cucm-uds/user/neo0" version="12.5.1"><id>a449d5c6-b39a-b4cc-e102-688adea4381a</id><userName>neo0</userName><firstName>OAuth</firstName><lastName>Sanity</lastName><middleName></middleName><nickName></nickName><displayName></displayName><emMaxLoginTime></emMaxLoginTime><allowProvisionEMMaxLoginTime>false</allowProvisionEMMaxLoginTime><phoneNumber></phoneNumber><homeNumber></homeNumber><mobileNumber></mobileNumber><mobileConnect>false</mobileConnect><remoteDestinationLimit>4</remoteDestinationLimit><userLocale uri="https://10.195.20.23:8443/cucm-uds/options/installedLocales" value="" appliesToAllDevices="true">English, United States</userLocale><email></email><directoryUri></directoryUri><msUri></msUri><department></department><manager></manager><title></title><pager></pager><selfServiceId></selfServiceId><accountType>local</accountType><homeCluster enableImAndPresence="false" enableCalendarPresence="false">true</homeCluster><imAndPresence/><enableDoNotDisturb appliesToAllDevices="true">false</enableDoNotDisturb><serviceProfile/><jabberProfile/><devices uri="https://10.195.20.23:8443/cucm-uds/user/neo0/devices"/><credentials uri="https://10.195.20.23:8443/cucm-uds/user/neo0/credentials"/><extensions uri="https://10.195.20.23:8443/cucm-uds/user/neo0/extensions"/><subscribedServices uri="https://10.195.20.23:8443/cucm-uds/user/neo0/subscribedServices"/><speedDials uri="https://10.195.20.23:8443/cucm-uds/user/neo0/speedDials"/></user>'
2020-11-24 19:17:06,217 - utils.utility - DEBUG - b'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><devices uri="https://10.195.20.23:8443/cucm-uds/user/neo0/devices" version="12.5.1"/>'
2020-11-24 19:17:06,218 - utils.implicit_grant - DEBUG - Test: Implicit Grant flow Start
2020-11-24 19:17:06,245 - utils.utility - DEBUG - b'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SSOResult><ErrorCode>0</ErrorCode><Response><SingleSignOn version="12.5.1.13900-152"><Status enabled="false"/><Token reuse="false"/><Uri>https://sj-vm20-23.cisco.com:8443/ssosp/oauth/authorize</Uri><allowEmbeddedSafari>false</allowEmbeddedSafari></SingleSignOn></Response></SSOResult>'
2020-11-24 19:17:06,370 - utils.implicit_grant - DEBUG - Implicit token: MjoxYTc2NWZiMS1hNGI4LTQ1NzYtOTJhZi00NGIyM2M3ODk1Y2Y
2020-11-24 19:17:06,509 - utils.utility - DEBUG - b'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><user uri="https://10.195.20.23:8443/cucm-uds/user/neo0" version="12.5.1"><id>a449d5c6-b39a-b4cc-e102-688adea4381a</id><userName>neo0</userName><firstName>OAuth</firstName><lastName>Sanity</lastName><middleName></middleName><nickName></nickName><displayName></displayName><emMaxLoginTime></emMaxLoginTime><allowProvisionEMMaxLoginTime>false</allowProvisionEMMaxLoginTime><phoneNumber></phoneNumber><homeNumber></homeNumber><mobileNumber></mobileNumber><mobileConnect>false</mobileConnect><remoteDestinationLimit>4</remoteDestinationLimit><userLocale uri="https://10.195.20.23:8443/cucm-uds/options/installedLocales" value="" appliesToAllDevices="true">English, United States</userLocale><email></email><directoryUri></directoryUri><msUri></msUri><department></department><manager></manager><title></title><pager></pager><selfServiceId></selfServiceId><accountType>local</accountType><homeCluster enableImAndPresence="false" enableCalendarPresence="false">true</homeCluster><imAndPresence/><enableDoNotDisturb appliesToAllDevices="true">false</enableDoNotDisturb><serviceProfile/><jabberProfile/><devices uri="https://10.195.20.23:8443/cucm-uds/user/neo0/devices"/><credentials uri="https://10.195.20.23:8443/cucm-uds/user/neo0/credentials"/><extensions uri="https://10.195.20.23:8443/cucm-uds/user/neo0/extensions"/><subscribedServices uri="https://10.195.20.23:8443/cucm-uds/user/neo0/subscribedServices"/><speedDials uri="https://10.195.20.23:8443/cucm-uds/user/neo0/speedDials"/></user>'
2020-11-24 19:17:06,617 - utils.utility - DEBUG - b'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><devices uri="https://10.195.20.23:8443/cucm-uds/user/neo0/devices" version="12.5.1"/>'
2020-11-24 19:17:06,662 - utils.utility - DEBUG - b'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><SSOResult><ErrorCode>0</ErrorCode><Response><SingleSignOn version="12.5.1.13900-152"><Status enabled="false"/><Token reuse="false"/><Uri>https://sj-vm20-23.cisco.com:8443/ssosp/oauth/authorize</Uri><allowEmbeddedSafari>false</allowEmbeddedSafari></SingleSignOn></Response></SSOResult>'
2020-11-24 19:17:06,665 - utils.not_happy - DEBUG - Test : Negative tests start
2020-11-24 19:17:06,761 - utils.not_happy - DEBUG - Authorization Code: ZmY5Y2UyNWYtNDE5MS00OWMxLTk2ODMtM2ExOGE5NDNiZmUy
2020-11-24 19:17:06,844 - utils.not_happy - DEBUG - Access token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjhhNTVhNmRkLTIwNmUtNDk1ZC1hMWYzLTMyNWVlMTQxYjRmYjoyZTcxZmJjODdlMjBjZGE0YjMwNGM2NzUwMzM3NWNkNDZjZWM4OTFjMTgwMDZlYzJkNzQ5OWJhNWZiMGViNmRiIn0.eyJwcml2YXRlIjoiZXlKaGJHY2lPaUprYVhJaUxDSmpkSGtpT2lKS1YxUWlMQ0psYm1NaU9pSkJNVEk0UTBKRExVaFRNalUySWl3aWEybGtJam9pT0dFMU5XRTJaR1F0TWpBMlpTMDBPVFZrTFdFeFpqTXRNekkxWldVeE5ERmlOR1ppT2pVNE9EYzNNbUpoTlRNd01XTm1aREptWXpabE1qYzJObVF6WmpoalpqbG1PR1kwWTJKaE1qRTNOVFUxWkROaU9UVm1PVFF6TXpnME4ySXhNekpsTkRraWZRLi5RVkg0NEFKLWVvenpOYUR4WklGY2FBLlR0U2ZYODhhcUFNS1lVcGh2OGphdXYyVU9pVFpZQXc1ZTZyYzZIWGtVM2Jfd05MaGVNSXAwUVNxLXJrRDlpcmhsMjJrUWRrOFlndXNxUGRDSkhkSk1aNXkydUNzMjhyeDUtdU1aeTYzWDFvZVFONUZTY0kzbmdOQk9FXzcyV21reEFRa1pOeUVONU45V2JGSmRKbXNSM1ZtSVhJalNoOTBoUXN2bFBLYjdaYUV0WlNWdzJfazU5NVdaeS1lbEpWanJhYUdCTlZZYnFZUk9oSko3UU02aV9MYzl3cnUwYjZENFVHSFlqRkdkaW5USUZ1eU02cWZLbHlyb3FoMkR2MWNQXzVOeFlnR1g3bjNkZXUyS0cxSm5yZGZFa2tIVWhmU2M0U3NpWXVldnBXR0x3YmlFWlA5R012bGU5bWZuUVo4WFZadmNsZzY1bDlhS0VTWWdVaUk0NVBtVExRNV96NmpNYk5MaEpZYUJ0WE0xTHRvbFU0VTJ3OC0wRE9CaFE3MUp4X0NKRkpERTZCcDdMeVZmQ3JGRWQyRl9LNDFaUUtIUE50U2NPdVFKNy1xeE44eWZUNncxR0N0ckxRZ1BSOXdoOThXdzVidjJLbEx2YmtGcEg5cGsyMWNiWm93My1OSGF1WEc4UnJTbVc5WnJVWU8wazVkcGpKamxRRXU5Y2NTVjl6X1B6UGw4cWtOb1lMUzhRM09rOURiQmQ3Sy1xczZNdDlmc2tsOG5yeHJyUzROSHp4a0FwQ2hrQklaSnhIMHJoODRyZmNOTVNKczlKV0pfMVRqbmNLRWFrbnZRa1YyX1gxTDFtcDRKejJPZkZ2S1d2cWtiNjBESkRLRVROSjJqamxpcEF1T005MGN1S0RUWUhkcXdXM3dGV2ExSEJieDBSZGFqdXZNTDlPUDFlWFlNUVRENVVoYUw4eEc4TXVYcWNnQjY4bm52ZHBYeGQzTTd3SnFDQTlLMldrN2RUbTdSTjJXZzJtUHhpQUhMeTBOZndCTnV3ZkVPZk0yS2xBR0Y1dWdwUWVja2FNMnBKd09tZHU5VzQwQTFzMFNCanQ4RDMzUU1PaVg0YTF1d3Jwd1pmUUZWQmtWcHpZWTdBM1UuOUd2MG1fVGdtbWdFdmd3X3YxY1pWUSJ9.rZvyg8Ty1BLDF2gALO3G7Be1hpoBSglim6s6p-bAP_UADsSqoMlY3-erNdU9OEmwT3hUF9F22nC4Dp3vW6o6o6npZHoA0211HqElQaQwLDsVZLeWpta1QUsoHeeEX7HeXcRnh4G87LaxU1xYp-DS2UqfG-sV0WvJukhjc1gRyg8rM_mlYP0ZKp_QnBYpxdLVTq0IPuii6qBvT7kCebLjcoFJnFH5pg5zou9aQjDYwI3SlU469dl3tJmHZDiVsyoNs4hwPnBU_KbPSxpcQOlwqgn87_P1IDNTwCgmDZ9VIa1tXgWUVgTSsjKaPD0cwoo57IqtzVzamARf0wUfaLIS9Q
2020-11-24 19:17:06,844 - utils.not_happy - DEBUG - Refresh token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjhhNTVhNmRkLTIwNmUtNDk1ZC1hMWYzLTMyNWVlMTQxYjRmYjoyZTcxZmJjODdlMjBjZGE0YjMwNGM2NzUwMzM3NWNkNDZjZWM4OTFjMTgwMDZlYzJkNzQ5OWJhNWZiMGViNmRiIn0.eyJleHAiOjE2MTE0OTc1NTUsImlzcyI6IjhhNTVhNmRkLTIwNmUtNDk1ZC1hMWYzLTMyNWVlMTQxYjRmYiIsInR5cCI6InVzZXIiLCJ0aWQiOiJhMGRjMDQ4My0xNTU4LTQ2ZTUtYjAzMC01OTk0MjYwNmQzNzIiLCJjdHlwIjoicmVmcmVzaCIsImNjaWQiOiJDM2IwYWZmZWZlMTQzOTA0MTY4M2U5YzJjMzdkMzZmNDM4ZWYwZWYyN2MwOTM4YWRjNjIyNmUwYzAzZDE2OWYyYSJ9.kgX2Rff7VJqKw_8uosfEpMAgjBOtxnIFwdjv4uZ6PJoflmofLu2bLnjwcaegcd7LjhuV8G_b04f6heSTAEiKbA6fMxSUKuiVO_fUfbBDLi_25_2MBCFR1BoSMJYwbSthMJ3GK2Um5Z-OStid5EjrE9R6fSAwsn1uG8rn4gKUfhx4kW7puNXu43AAbJCGpurG743pniHSqgDbXwWwJQ4t9QOFEmqhDbRQ4COW1Ts-0FJpg7pHwOl98CHaNtQrn3Icf8ePMgAk4Tbae65nCePE_OZaATzotaU4v37erYzjmPZabrKKnravHtBfJvykJmHa24U5VOJrQTFz6IDW63vlUQ
2020-11-24 19:17:06,885 - utils.not_happy - DEBUG - Test 1: Use invalid username passed
2020-11-24 19:17:06,968 - utils.not_happy - DEBUG - Test 2: Use invalid password passed
2020-11-24 19:17:07,051 - utils.not_happy - DEBUG - Test 3: Use invalid response type passed
2020-11-24 19:17:07,086 - utils.not_happy - DEBUG - Test 4: Use invalid auth code test passed
2020-11-24 19:17:07,208 - utils.not_happy - DEBUG - Test 5: Get tokens using invalid clientID, valid Code
2020-11-24 19:17:07,247 - utils.not_happy - DEBUG - Test 6: Get the tokens, using invalid clientID, valid refresh token
2020-11-24 19:17:07,283 - utils.not_happy - DEBUG - Test 7: Get the tokens, using valid clientID, invalid refresh token
2020-11-24 19:17:07,395 - utils.not_happy - DEBUG - Test 8: Get the tokens, using invali grant type, valid code
2020-11-24 19:17:07,422 - utils.not_happy - DEBUG - Test 9: Get the tokens, using invalid grant type, valid refresh token
2020-11-24 19:17:07,483 - utils.not_happy - DEBUG - Test 10: Get the code using missing clientID
2020-11-24 19:17:07,534 - utils.not_happy - DEBUG - Test 11: Get the code using missing response_type
2020-11-24 19:17:07,562 - utils.not_happy - DEBUG - Test 12: Get the code using missing username
2020-11-24 19:17:07,617 - utils.not_happy - DEBUG - Test 13: Get the code using missing password
2020-11-24 19:17:07,777 - utils.not_happy - DEBUG - Test 14: Get tokens using  missing client_id
2020-11-24 19:17:07,902 - utils.not_happy - DEBUG - Test 15: Get tokens using  missing grant_type
2020-11-24 19:17:07,930 - utils.not_happy - DEBUG - Test 16: Get tokens using  missing code
2020-11-24 19:17:07,964 - utils.not_happy - DEBUG - Test 17: Get tokens using  missing clientID, using RT
2020-11-24 19:17:08,003 - utils.not_happy - DEBUG - Test 18: Get tokens using  missing grant_type, using RT
2020-11-24 19:17:08,038 - utils.not_happy - DEBUG - Test 19: Get tokens using  missing refresh token, using RT
2020-11-24 19:17:08,097 - utils.not_happy - DEBUG - Test 20: authorization code using invalid state param (larger than 4 bytes)
2020-11-24 19:17:08,139 - utils.not_happy - DEBUG - Keys pulled from the the server b'<!-- custom Cisco error page --><html>    <head>        <title>            Cisco System - null        </title>        <style type="text/css">            a {                color: #316984;                text-decoration: none;            }            a:hover {                color: #316984;                text-decoration: underline;            }            a:visted {                color: #316984;                text-decoration: none;            }            body {                background-attachment: fixed;                background-color: #ffffff;                background-repeat: no-repeat;                color: #316984;                font-family: arial,helvetica,sans-serif;            }            #content {                border: 1px solid #d6d7d6;                font-size: 93.5%;                margin: 0px 10% 30px 10%;            }            #content-header {                background-color: #eeeeee;                border-bottom: 1px solid #666666;                color: #666666;                font-size: 124.5%;                padding: 5px 15px 5px 15px;            }            #copyright {                font-size: 75%;                margin: 0px 10% 0px 10%;                padding: 3px 0px 0px 0px;                text-align: right;            }            img {                display: block;                margin: 0px 0px 20px 0px;            }            #logo {                margin: 30px 10% 0px 10%;            }            p {                padding: 5px 15px 5px 15px;            }            pre {                padding: 5px 15px 5px 30px;            }        </style>    </head>    <body>        <div id="logo">            <img src="/ciscologo.gif" alt="Cisco Systems, Inc." />        </div>        <div id="content">            <div id="content-header">HTTP Status 401 \xe2\x80\x93             </div>            <p>                <b>                    type:               </b> Status Report            </p>            <p>                <b>Message:               </b>             </p>            <p>                <b>Description:               </b> http.401            </p>        </div>    </body></html>'
2020-11-24 19:17:08,141 - utils.not_happy - DEBUG - Test 21: Get the authorization keys from ssosp, using invalid username
2020-11-24 19:17:08,192 - utils.not_happy - DEBUG - Keys pulled from the the server b'<!-- custom Cisco error page --><html>    <head>        <title>            Cisco System - null        </title>        <style type="text/css">            a {                color: #316984;                text-decoration: none;            }            a:hover {                color: #316984;                text-decoration: underline;            }            a:visted {                color: #316984;                text-decoration: none;            }            body {                background-attachment: fixed;                background-color: #ffffff;                background-repeat: no-repeat;                color: #316984;                font-family: arial,helvetica,sans-serif;            }            #content {                border: 1px solid #d6d7d6;                font-size: 93.5%;                margin: 0px 10% 30px 10%;            }            #content-header {                background-color: #eeeeee;                border-bottom: 1px solid #666666;                color: #666666;                font-size: 124.5%;                padding: 5px 15px 5px 15px;            }            #copyright {                font-size: 75%;                margin: 0px 10% 0px 10%;                padding: 3px 0px 0px 0px;                text-align: right;            }            img {                display: block;                margin: 0px 0px 20px 0px;            }            #logo {                margin: 30px 10% 0px 10%;            }            p {                padding: 5px 15px 5px 15px;            }            pre {                padding: 5px 15px 5px 30px;            }        </style>    </head>    <body>        <div id="logo">            <img src="/ciscologo.gif" alt="Cisco Systems, Inc." />        </div>        <div id="content">            <div id="content-header">HTTP Status 403 \xe2\x80\x93 Access to the requested resource has been denied            </div>            <p>                <b>                    type:               </b> Status Report            </p>            <p>                <b>Message:               </b> Access to the requested resource has been denied            </p>            <p>                <b>Description:               </b> http.403            </p>        </div>    </body></html>'
2020-11-24 19:17:08,193 - utils.not_happy - DEBUG - Test 22: Get the authorization keys from ssosp, using valid credentials, invalid role
2020-11-24 19:17:08,261 - utils.not_happy - DEBUG - Keys pulled from the the server b'{"error":"Bad Request","error_description":"KeyID unknown"}'
2020-11-24 19:17:08,261 - utils.not_happy - DEBUG - Test 23: Get the authorization keys from ssosp, using invalid keyid
2020-11-24 19:17:08,322 - utils.not_happy - DEBUG - Keys pulled from the the server b'{"error":"Bad Request","error_description":"KeyID unknown"}'
2020-11-24 19:17:08,323 - utils.not_happy - DEBUG - Test 24: Get the authorization keys from ssosp, using empty keyID
2020-11-24 19:17:08,323 - utils.remote_verify - DEBUG - Test : Remote token Verification Start
2020-11-24 19:17:08,420 - utils.remote_verify - DEBUG - Authorization Code: OGViZTU0MjEtNzY0Yi00OTIzLWFmZTUtNzAwY2QwZmU3MGUy
2020-11-24 19:17:08,580 - utils.remote_verify - DEBUG - Access token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjhhNTVhNmRkLTIwNmUtNDk1ZC1hMWYzLTMyNWVlMTQxYjRmYjoyZTcxZmJjODdlMjBjZGE0YjMwNGM2NzUwMzM3NWNkNDZjZWM4OTFjMTgwMDZlYzJkNzQ5OWJhNWZiMGViNmRiIn0.eyJwcml2YXRlIjoiZXlKaGJHY2lPaUprYVhJaUxDSmpkSGtpT2lKS1YxUWlMQ0psYm1NaU9pSkJNVEk0UTBKRExVaFRNalUySWl3aWEybGtJam9pT0dFMU5XRTJaR1F0TWpBMlpTMDBPVFZrTFdFeFpqTXRNekkxWldVeE5ERmlOR1ppT2pVNE9EYzNNbUpoTlRNd01XTm1aREptWXpabE1qYzJObVF6WmpoalpqbG1PR1kwWTJKaE1qRTNOVFUxWkROaU9UVm1PVFF6TXpnME4ySXhNekpsTkRraWZRLi5NWko2TFZGQTRpMkRobXFZWFRFMzRnLmJJckVxSW5aX1d3WGlrdkVmeXV3SlhkdXFvQWxuNXZPS0toTUZjbjIyT2RidE9JMHIwOFNDZ2NBeG1OZDRUYmt3OUpkNkdyTW1oTzk5UUtoZEYzdEJsUFN2WG1oWjJDRWJyY0lWcEVKM2JRd285bEEzSVFkdVRGa1F4ZXRjdXpnZTlkOVBUVDJ0TDBGcDNONEhuTTZERWlUak5UVm9ZWHVBOXlUTEVGVV9uYUZobHl1bjE0dlNDcXVGS0ZMY2otRDlVdzR2RFl3b050TlhFWlBOQlFMYUJ2NXZwU05QYUVKQ3RHaEQtdU9nS0RWQWN5YnFvb1lxMlFkSEljYm9Jc1RzODQ0YWdaTVRaUE10a3BEdWlvaFNGbTRBdGhOWlNSZl9xd29YYy1HdHhBMEpwYlNHNmxwbklVU1QzUFkxV2I2NlEzYW9pTkNFcm92SXVoYy1sZUZXRVpWbTFyQnNTbm1LWlpwbjZjaHRYV3BqUlQ4UkttWklWaklTWTFTLTFtQTRFV1cxOUtDcjRabmFIcnkyaHppaUJ4QXNZTnNISThhYmJqODRia0VqaXFURVNUTWt0LW1RUWZ5X1JxbEMyTmo2b2NjTHAyV0c1WVZBOGRGZ2JGcm9rNXg3SFl4QVpqaEY4ejM5N3lVdHY5QjJQNXBld0sxWWhmbzZSMWQ4bThZdVlPc1oxRE4tVFBUMDZ3ZEw0Y0t1QmRFSWhnRnNlYzVLSndDdzhRdEswZVhTdTl5c2tHZU1hN1ZQUHVLOGZucGI1TWhHaWFRNUk0UHJJNDdhRmdDWWNlTUdjMGduRjA3b2hYQkNybS1iRnNlcDZ4Zzg3T0tzbEZIaGd0aENXYTNyODl3a1NWazJrZWpZR0QzNnliSDFIS2ZBWkFzaUdnZUtBVUoxNExqLVoyWnNLclBDUEwzcjhtS0gxV0tMZzZuNC1NY01FczNRVG5CdmxDQTN4eHJvVDdOLUxjeUZWX1VtNXBJSkxtRERNU1A4MjB5TkVNblJJN2lGRDhJLWU5RElVemY4STdGZUl2UU9uQ3gxZUF4aGpoS28ybTBaTUlkYjJHVDNJMVYwSk9DaUhNUUxSajRHd1pqN1RCYnpWZnAuZnJ0VW1kbGlIYVgtVVFOa3dham9CdyJ9.hOEi6k2PiwNfWdr9BgvTU467OClny9-24Y6iMj3RIuK2Yv-hIVcFrE2a3CIpY6ks1CLf5KsUy57tNrC0AWDSakB-BW-0v7BOBSUddorGAO-ljN2129GQpFllh9csbmgXgAk63W4-9GIJVzjUS8NSG7jUvpfm8HD6ai2DSjhQJ4P6qN9_brzomkgTiOhWWT0NsLy_9wFxDDGCXxC6kqZ71ZgAe5BmRs_jdZokJrF4BRJa_pgsk5I_PzF3m1uRAiSGkRvYJ995n2KFMUCaFfkJCTiaVOmdHfzLafYAKQAFWh7dVuFKYishQWrDQN6jvo7nMRvYfqQTgxmxpduPhUipeQ
2020-11-24 19:17:08,581 - utils.remote_verify - DEBUG - Refresh token: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjhhNTVhNmRkLTIwNmUtNDk1ZC1hMWYzLTMyNWVlMTQxYjRmYjoyZTcxZmJjODdlMjBjZGE0YjMwNGM2NzUwMzM3NWNkNDZjZWM4OTFjMTgwMDZlYzJkNzQ5OWJhNWZiMGViNmRiIn0.eyJleHAiOjE2MTE0OTc1NTYsImlzcyI6IjhhNTVhNmRkLTIwNmUtNDk1ZC1hMWYzLTMyNWVlMTQxYjRmYiIsInR5cCI6InVzZXIiLCJ0aWQiOiJkMWU0OTNlYi1jNGVjLTQyOTktOTBjYi1lODVjMGM1NTNiZDUiLCJjdHlwIjoicmVmcmVzaCIsImNjaWQiOiJDM2IwYWZmZWZlMTQzOTA0MTY4M2U5YzJjMzdkMzZmNDM4ZWYwZWYyN2MwOTM4YWRjNjIyNmUwYzAzZDE2OWYyYSJ9.wo5WtmhDUtteBNr4UHOftsE7GAXV3Yw_3FXlelPgvNqmyLK0izaFxxynsqPJ4Vi8KViml-v1y--N3zbeFXO0tkPvfxucYpG5v0Wyb9q7cxwbcQ1RhJsZflzg1-6-moh0S8R5FmEXKkYfrd3hms2FdEy27RFJI6nqB9HJ1uNZHqxBRj3M4olyIRFbT-mOi-qEP_aDdI2LQJ5TqE-Y0rmmj8fMn0SIFDz6mnwNoicHY2wx6v75-ReKr0oL_zCyYMEtUaT1LvffKD7jyz-K5V8W0iNDlZwkt_2705WT_OMlCWao-z-KY8TC-4J2Sd_6Ybz2F6RDH276xlQrEh4j-l80tQ
2020-11-24 19:17:08,648 - utils.remote_verify - DEBUG - Keys pulled from the the server b'{"keys":[\n{"purpose":"Verify",\n"id":"8a55a6dd-206e-495d-a1f3-325ee141b4fb:2e71fbc87e20cda4b304c67503375cd46cec891c18006ec2d7499ba5fb0eb6db",\n"value":"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzYxpx/0yEeLfTpdeeDOd54RQWGjeg0BjCeMNIQy5b2ylhlZ4mQJEqwPOv3NZ1eN46+juxCNHOqPIiIbx2plv7KVoTLNf+CnzVzRTO7BinwElMekRa24S070f6/gYLHWMTwOLozH1OZDrc0xYAibpH4cSO/KfVmPGuoOs4bQQcJ/C/rftjl8PZFOW6ULeO7Al6v6vR/wej8yNgZOvIXD89/lolBmDHwSRSgfp7TBbRrOHk9pzTGqkWE+zXb9eelingXJbd+8DvaZ2MTfKXaExSrIyPJYV9Pe/vvO6B3XcQr7iGdtF/sgpl86sKh1rW0AmRJ8Pd37slz2Zo2cAB+3EjQIDAQAB"},\n{"purpose":"Decrypt",\n"id":"8a55a6dd-206e-495d-a1f3-325ee141b4fb:588772ba5301cfd2fc6e2766d3f8cf9f8f4cba217555d3b95f9433847b132e49",\n"value":"xTbXI6pm+Wp3R+meEyb7+iSF3Grurg0E4GZjhY8fGw0="}\n]}'
2020-11-24 19:17:08,648 - utils.remote_verify - DEBUG - Keys pulled from server: b'{"keys":[\n{"purpose":"Verify",\n"id":"8a55a6dd-206e-495d-a1f3-325ee141b4fb:2e71fbc87e20cda4b304c67503375cd46cec891c18006ec2d7499ba5fb0eb6db",\n"value":"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzYxpx/0yEeLfTpdeeDOd54RQWGjeg0BjCeMNIQy5b2ylhlZ4mQJEqwPOv3NZ1eN46+juxCNHOqPIiIbx2plv7KVoTLNf+CnzVzRTO7BinwElMekRa24S070f6/gYLHWMTwOLozH1OZDrc0xYAibpH4cSO/KfVmPGuoOs4bQQcJ/C/rftjl8PZFOW6ULeO7Al6v6vR/wej8yNgZOvIXD89/lolBmDHwSRSgfp7TBbRrOHk9pzTGqkWE+zXb9eelingXJbd+8DvaZ2MTfKXaExSrIyPJYV9Pe/vvO6B3XcQr7iGdtF/sgpl86sKh1rW0AmRJ8Pd37slz2Zo2cAB+3EjQIDAQAB"},\n{"purpose":"Decrypt",\n"id":"8a55a6dd-206e-495d-a1f3-325ee141b4fb:588772ba5301cfd2fc6e2766d3f8cf9f8f4cba217555d3b95f9433847b132e49",\n"value":"xTbXI6pm+Wp3R+meEyb7+iSF3Grurg0E4GZjhY8fGw0="}\n]}'
2020-11-24 19:17:08,654 - utils.remote_verify - DEBUG - b'{"scopes":["im & presence","voice","video"],"exp":1606317156,"sub":"neo0","siss":"JJ7wyFAcNgBvEqb6AeOKxJWdenbCK1keKkHVGatzF1\\/aLbprhyhhjRkmduFDH1IJeinRCgV4D5EC1sRp2x7hteg5uIJxsmGKKiIaqKnAgb0WXoCyYBsd3YxdU2xneSsHbaBFrC8S35ItZTvjitnm9IuLORFUXiKVuCbN+siN5S3wO2LfIK6\\/7TZxYueRPdGxhOqEnH+lxM2pwEzONTXf2ZzXZmsLYepV\\/XQqLLoPo5Z2AA+Qo9lzJNdOtTZ1YPBx2Mt+pR7jUfrV4wnRhPEDq9kjtdMiUPObekIz2002J4aerrhK7h2lUI4UVfZg7eY1zOXaCPRTsPZnBllCpSYT+g==","iss":"8a55a6dd-206e-495d-a1f3-325ee141b4fb","tid":"03f52d05-a3b1-4831-804a-2c6f7b6f70de","ctyp":"Bearer","ccid":"C3b0affefe1439041683e9c2c37d36f438ef0ef27c0938adc6226e0c03d169f2a"}'
2020-11-24 19:17:08,654 - utils.remote_verify - DEBUG - Token issued to user neo0, with scopes ['im & presence', 'voice', 'video'] is valid until Wed Nov 25 07:12:36 2020
2020-11-24 19:17:08,654 - utils.scopes_check - DEBUG - Test : Remote token Verification with different scopes Start
2020-11-24 19:17:08,721 - utils.scopes_check - DEBUG - Keys pulled from the the server b'{"keys":[\n{"purpose":"Verify",\n"id":"8a55a6dd-206e-495d-a1f3-325ee141b4fb:2e71fbc87e20cda4b304c67503375cd46cec891c18006ec2d7499ba5fb0eb6db",\n"value":"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzYxpx/0yEeLfTpdeeDOd54RQWGjeg0BjCeMNIQy5b2ylhlZ4mQJEqwPOv3NZ1eN46+juxCNHOqPIiIbx2plv7KVoTLNf+CnzVzRTO7BinwElMekRa24S070f6/gYLHWMTwOLozH1OZDrc0xYAibpH4cSO/KfVmPGuoOs4bQQcJ/C/rftjl8PZFOW6ULeO7Al6v6vR/wej8yNgZOvIXD89/lolBmDHwSRSgfp7TBbRrOHk9pzTGqkWE+zXb9eelingXJbd+8DvaZ2MTfKXaExSrIyPJYV9Pe/vvO6B3XcQr7iGdtF/sgpl86sKh1rW0AmRJ8Pd37slz2Zo2cAB+3EjQIDAQAB"},\n{"purpose":"Decrypt",\n"id":"8a55a6dd-206e-495d-a1f3-325ee141b4fb:588772ba5301cfd2fc6e2766d3f8cf9f8f4cba217555d3b95f9433847b132e49",\n"value":"xTbXI6pm+Wp3R+meEyb7+iSF3Grurg0E4GZjhY8fGw0="}\n]}'
2020-11-24 19:17:08,721 - utils.scopes_check - DEBUG - Keys pulled from server: b'{"keys":[\n{"purpose":"Verify",\n"id":"8a55a6dd-206e-495d-a1f3-325ee141b4fb:2e71fbc87e20cda4b304c67503375cd46cec891c18006ec2d7499ba5fb0eb6db",\n"value":"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzYxpx/0yEeLfTpdeeDOd54RQWGjeg0BjCeMNIQy5b2ylhlZ4mQJEqwPOv3NZ1eN46+juxCNHOqPIiIbx2plv7KVoTLNf+CnzVzRTO7BinwElMekRa24S070f6/gYLHWMTwOLozH1OZDrc0xYAibpH4cSO/KfVmPGuoOs4bQQcJ/C/rftjl8PZFOW6ULeO7Al6v6vR/wej8yNgZOvIXD89/lolBmDHwSRSgfp7TBbRrOHk9pzTGqkWE+zXb9eelingXJbd+8DvaZ2MTfKXaExSrIyPJYV9Pe/vvO6B3XcQr7iGdtF/sgpl86sKh1rW0AmRJ8Pd37slz2Zo2cAB+3EjQIDAQAB"},\n{"purpose":"Decrypt",\n"id":"8a55a6dd-206e-495d-a1f3-325ee141b4fb:588772ba5301cfd2fc6e2766d3f8cf9f8f4cba217555d3b95f9433847b132e49",\n"value":"xTbXI6pm+Wp3R+meEyb7+iSF3Grurg0E4GZjhY8fGw0="}\n]}'
2020-11-24 19:17:11,107 - utils.utility - DEBUG - Added user profile successfully {
    'return': '{B2475893-7470-B635-ED21-D38FAC1D7F61}',
    'sequence': None
}
2020-11-24 19:17:13,174 - utils.utility - DEBUG - Test Setup: User full_scope with profile full_scope added successfully
2020-11-24 19:17:15,189 - utils.utility - DEBUG - Added user profile successfully {
    'return': '{C6BBE4C1-D58C-8599-641D-49D360BEFBAA}',
    'sequence': None
}
2020-11-24 19:17:17,234 - utils.utility - DEBUG - Test Setup: User im_only with profile im_only added successfully
2020-11-24 19:17:19,249 - utils.utility - DEBUG - Added user profile successfully {
    'return': '{A747DA0D-CF3F-5CC6-873C-55C98DE3360E}',
    'sequence': None
}
2020-11-24 19:17:21,345 - utils.utility - DEBUG - Test Setup: User no_service with profile no_service added successfully
2020-11-24 19:17:21,345 - utils.utility - DEBUG - All profiles added succesfully
2020-11-24 19:17:21,449 - utils.scopes_check - DEBUG - Authorization Code for user full_scope : OWI5YzIzZWUtYjM1NC00ZDkzLThiOTYtOTU0ZDYxODA2ZDRi
2020-11-24 19:17:21,585 - utils.scopes_check - DEBUG - Access token for user full_scope : eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjhhNTVhNmRkLTIwNmUtNDk1ZC1hMWYzLTMyNWVlMTQxYjRmYjoyZTcxZmJjODdlMjBjZGE0YjMwNGM2NzUwMzM3NWNkNDZjZWM4OTFjMTgwMDZlYzJkNzQ5OWJhNWZiMGViNmRiIn0.eyJwcml2YXRlIjoiZXlKaGJHY2lPaUprYVhJaUxDSmpkSGtpT2lKS1YxUWlMQ0psYm1NaU9pSkJNVEk0UTBKRExVaFRNalUySWl3aWEybGtJam9pT0dFMU5XRTJaR1F0TWpBMlpTMDBPVFZrTFdFeFpqTXRNekkxWldVeE5ERmlOR1ppT2pVNE9EYzNNbUpoTlRNd01XTm1aREptWXpabE1qYzJObVF6WmpoalpqbG1PR1kwWTJKaE1qRTNOVFUxWkROaU9UVm1PVFF6TXpnME4ySXhNekpsTkRraWZRLi52MnBCU1htUmdWODFwZldNSDJ6eFJnLnVJdTdLc0N0NVFJOTFCNEczY3h5Q09IU3ZkS1UxdGNob2xhRk5PaFdnNkt1c1dPNGp0c1AyWVJKSk9ERnhHV0F2NC1JeVN2ZnhVZkE1cGQtN0kxMmxCWm9GdFFueVhYWHRIRFFhZzIzV18xeVU3OVhNR1V2eWVMNzIya2xjblZxZ2VrWG9vM2pMZkFjZzBVT1hKZGxoektOTlFwQ05hZXVITVVFazY1UGRNSTBuOFZIakJaNHNHZXdCV2RwYWYwU2F4bFpsdVJPVThrdlAxUlZsdWhRbWlNbFBYSXJVVm9ZNWVmU3B3eVdGa1paZ2w0cUg4ZHBwZ0RXTUFmcTFONG1vRTBUa3BYaENjVTlfZ1BPTXpBMThkZy1NNHljcTllVlFmRXBUdXNSUWpQV3VwOFNncVhZTF9WQ3pSYjl0MERaMDQ1akdjWklwT3JlV3VaQThUa2YxS3FsaFk1cWxXOEVWVVhSeTFOZ2pObTJjVWU4TlNnQ2h1UWh1TXh3SHMyZGRSQU1HclFJMlBZTHRTVmlKWWFoMEJuMDBsbjBoWE1xR0ItRWtaUFJOZG5VbVhpcFVCNWY0b3F4bm0tc0NwbEpQM0NVbmxaY1dLMW9NQ1FObVNmMXNwZnotc2c1c3NvejR5Mzc4S3R0d3dwOVVkcUtqaDlDeExIVmdueFphbF9VaW9IekE5eDBNQTZiNFVnaF9NY3llbXhVM1IwU01LZmlWU3NUTjNfM3l3dFZEUWZ6VkMyQ1EwZkEzbmxmUVowR2NFR2lweUNKM2pVZGJjUXIzOEpOLWJyeVNVVUpVeU5vOXdMX1hIb2hKdWRjdlZZakpIZVlpQjBvaEx6SWxWdkJuNWQzc0xuU2VORVdfUUNnNjVpX1R2NkxvMHhOcGFLOXNLQUFqRFB3bmE4MzNmck5LWmxidE14M3YwSEVkQW9BejVOVmpxWjJ5NTFBRnI3Y3Y1Sm5FUW9SYVZZV0N5TFpXVkZETXAySmM1em1WbDJLdllHdTdNNlNJbzNiaUM1LS1neGtVZnNUc2o0T0EtSW5qWjBQd1h6YWlzVFZ4S0tZeHlMV3dBVjJBRktNbnlvS0dKNkU5aUVSM3o5Y05tWFEuVmVDMjFKMjliMmgzc0ltdW42TXoyQSJ9.aFnHvIe3IxYakW1NeuwqZkry-MWEDiVuwm5nxBFdiInnex4cnAIMF9yxVcGto9KWxqf-FzgnQuBBrMGIReXe_ZLV1ytJGpAB-ugypFvyI9d3ecEtTNZWV2zXsTP3CXbUxisD4DyCMDVL4sNDbajMv6oJV6HUSnCdg0m7sFvKr38VQ9RV94J1-iJGzkRbEYpYrZizjYBkBeylMG5iRqhOE-MKEwzI1ay-Cpb0TL071ycLpYwrNu8FoG1oYqB_WBKTUX3XNfJpePF8Qi-6ZHlkVFDCNdOy9PKPO8CsdL4ERN6tvZPGoIXMXgBMYeUgFv0728-GPnZeSWAgLkPkkTfjOQ
2020-11-24 19:17:21,586 - utils.scopes_check - DEBUG - Refresh token for user full_scope : eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjhhNTVhNmRkLTIwNmUtNDk1ZC1hMWYzLTMyNWVlMTQxYjRmYjoyZTcxZmJjODdlMjBjZGE0YjMwNGM2NzUwMzM3NWNkNDZjZWM4OTFjMTgwMDZlYzJkNzQ5OWJhNWZiMGViNmRiIn0.eyJleHAiOjE2MTE0OTc1NjksImlzcyI6IjhhNTVhNmRkLTIwNmUtNDk1ZC1hMWYzLTMyNWVlMTQxYjRmYiIsInR5cCI6InVzZXIiLCJ0aWQiOiIwOWUxZmIxNi0zYjFkLTRlNmItYmIyOC1iYjQ3NWYxZjYyYTciLCJjdHlwIjoicmVmcmVzaCIsImNjaWQiOiJDM2IwYWZmZWZlMTQzOTA0MTY4M2U5YzJjMzdkMzZmNDM4ZWYwZWYyN2MwOTM4YWRjNjIyNmUwYzAzZDE2OWYyYSJ9.Zf94Bniw6SkwA3nZ2Rcx8mw0YskiRx1le5fYnsauTEzNGjuVf0mK1MBGtA_48kMQa1VDK91eAGPgY1JkPbrW7xmZ_8EjWMiDI8TWO1Xq9o5iQHt9oy_QxUlGaCtjptPOChyBwbm8z7Dz7La8Un5pbCgheqzuWwcc28yZxvaZrs5pgNZVAFDb-8Nc3FqsB17DpmZnyknKjH56-LPAM8sKWs2CuRmDTgsTBrtbUtImyVRh3vJI6QI8mX1y8_T4uAgT3lpPAbDqjP-afkH9PiCvKh__qY2z1scHVQrww3Ck01ffq-tP0hWexvdm9rGCETyhaX_Jm1Vwxxi-lVMkEaffhA
2020-11-24 19:17:21,588 - utils.scopes_check - DEBUG - b'{"scopes":["im & presence","voice","video"],"exp":1606317169,"sub":"full_scope","siss":"JJ7wyFAcNgBvEqb6AeOKxJWdenbCK1keKkHVGatzF1\\/aLbprhyhhjRkmduFDH1IJeinRCgV4D5EC1sRp2x7hteg5uIJxsmGKKiIaqKnAgb0WXoCyYBsd3YxdU2xneSsHbaBFrC8S35ItZTvjitnm9IuLORFUXiKVuCbN+siN5S3wO2LfIK6\\/7TZxYueRPdGxhOqEnH+lxM2pwEzONTXf2ZzXZmsLYepV\\/XQqLLoPo5Z2AA+Qo9lzJNdOtTZ1YPBx2Mt+pR7jUfrV4wnRhPEDq9kjtdMiUPObekIz2002J4aerrhK7h2lUI4UVfZg7eY1zOXaCPRTsPZnBllCpSYT+g==","iss":"8a55a6dd-206e-495d-a1f3-325ee141b4fb","tid":"b7fb6ea7-e87e-48c6-94d0-d1445859f656","ctyp":"Bearer","ccid":"C3b0affefe1439041683e9c2c37d36f438ef0ef27c0938adc6226e0c03d169f2a"}'
2020-11-24 19:17:21,589 - utils.scopes_check - DEBUG - Token issued to user full_scope, with scopes ['im & presence', 'voice', 'video'] is valid until Wed Nov 25 07:12:49 2020
2020-11-24 19:17:21,589 - utils.scopes_check - DEBUG - Test for user full_scope passed
2020-11-24 19:17:21,692 - utils.scopes_check - DEBUG - Authorization Code for user im_only : Njc3YWM4NWQtZTM5Zi00NTA5LTg2YTktYTBjZTBmM2EzM2Mx
2020-11-24 19:17:21,799 - utils.scopes_check - DEBUG - Access token for user im_only : eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjhhNTVhNmRkLTIwNmUtNDk1ZC1hMWYzLTMyNWVlMTQxYjRmYjoyZTcxZmJjODdlMjBjZGE0YjMwNGM2NzUwMzM3NWNkNDZjZWM4OTFjMTgwMDZlYzJkNzQ5OWJhNWZiMGViNmRiIn0.eyJwcml2YXRlIjoiZXlKaGJHY2lPaUprYVhJaUxDSmpkSGtpT2lKS1YxUWlMQ0psYm1NaU9pSkJNVEk0UTBKRExVaFRNalUySWl3aWEybGtJam9pT0dFMU5XRTJaR1F0TWpBMlpTMDBPVFZrTFdFeFpqTXRNekkxWldVeE5ERmlOR1ppT2pVNE9EYzNNbUpoTlRNd01XTm1aREptWXpabE1qYzJObVF6WmpoalpqbG1PR1kwWTJKaE1qRTNOVFUxWkROaU9UVm1PVFF6TXpnME4ySXhNekpsTkRraWZRLi5nSW5HNVJkZmRhS3V2SUNXUUw3OGlBLi1QY1p1ZkVrQ0Y1U24zcm9laXh1N091UWJWQ3ZmdzZzWlNfT29CTDJGMEoxWWpBSmlIbGdaVlNSMF9oTlUya1h0X011MFZ0dGFObkFTTldTTG43QTE4ZmZQRGNQd2d5OXRVN0FDWUdwdTh0R2dUVkpta3d1NkNYRzF1anFDYUdtZ202eFZwbmdkdFVseGRHVHdQYUowVG1sYVEwM3duWjRaN0tfTWlmdWxzY3lCUDgtdXp3amtSMThLNDZLQ0FiT3JqVEtiNTN4and2NXd5R2NkWWV6TEpiUF9qZndwQVcwb081TUJaU0RtX0U1OHRGRk5zbVN1VXBYb3k3RndtNkdWVFBIejUtVnZBTWRYYlFiTlNNUkRMMmc4UWxKamV4UmNiZ2VQUC1YZ0x0WUcxd3M0ejVzR2JFS2YwN2dhLVdjN1FRZ0tsS2Z2b05ZOXdPa2c5Nm5hSnVSa013RFpoU3BxYmpVRk1JVVNZRmVOa2laRS1OYjRFWlJTZU9JY3ZleW1fM3kwOEt2UmE5Qkl4bEFCNk1ycEVlY2lLV2VtRENlY3BZci16aE9jdVkwekVsUnFic2NsaEgzbFRYM2V4NVhIMmZUMi1aNjJFdG1IMG5ZYnhjR1FxSVNzeXRKbWVTbW5JZ01ZTlRLdlJ0UWdIajQxMzlKZjIxbUJnb0JwR2c2Z0J6OVB3TWFmS19YaUc0akYxclkyaDF2cXFtcVdTTUdCSlE0cVloNmZIT3dJc2Rhbmt5b080RG10T1U4ZUpQNEUxQncycUtvT3dZWnVNMHFLd0RFQjhqN3A4MmxSWHExdXBkamFkdnZGODZPbC1GWi1yMkRyRUZwYldrbDJrQTgwcDN1bF9yWGx0VFh2Um4wa2hzQzROWF9QQzZ3SWpncVhkR3ZfOXVyLTQxOE5kSllJQXdFeWYtcmd1VFg2cE1mYnBEeHJiVFNibGVtbVlVZF9GbWdpLVZGa2hFeFBWd3UyNmpqTC03Znc1R3FmS1lFZHotWVFnWjhPZTR1LUFSTXRvZnNZQi05MDNyV0h1M25IOXhGRUp6T215dlJielBLQ0FjR18xclVWUGMuMmJXR1NpeFN2N3BvUjNtNUprbDVSUSJ9.wvVaMuRr8ffeSBOkzOPo8xobQ7i1G8Ec9Rd_olgdKyF8RwzXUSCKaWTMLs1ezbYU9yBfWO5BjfG3t9ZKtYWFeW8eZrir5e3PYp6P9l9_SzlA7SbAyiS0Smg9boU482e4E4GMlno-ZLKjeS1_CuJpaLx0c-fFkr7z0o3wJx0lXjW8CioHQdvd2zQS3unlQISGDdNYSZ0DiUXAiQw6bwwWZebQkT86muw143Vq3slTq8tCBIiutjbTlzEc51jHsWMp2gZf2APzNki_2W1cgxyuw6keCLn7ogiINg2akTBn1-5mgugpI8gMMhC6lxUD-7TyAhlSu5UESW_gnLAVg0ct5Q
2020-11-24 19:17:21,800 - utils.scopes_check - DEBUG - Refresh token for user im_only : eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjhhNTVhNmRkLTIwNmUtNDk1ZC1hMWYzLTMyNWVlMTQxYjRmYjoyZTcxZmJjODdlMjBjZGE0YjMwNGM2NzUwMzM3NWNkNDZjZWM4OTFjMTgwMDZlYzJkNzQ5OWJhNWZiMGViNmRiIn0.eyJleHAiOjE2MTE0OTc1NzAsImlzcyI6IjhhNTVhNmRkLTIwNmUtNDk1ZC1hMWYzLTMyNWVlMTQxYjRmYiIsInR5cCI6InVzZXIiLCJ0aWQiOiI0YzQ5YTc1OS0wOTRhLTQ0MDUtOTY5NC1kZDFmNGMwMTlkZmYiLCJjdHlwIjoicmVmcmVzaCIsImNjaWQiOiJDM2IwYWZmZWZlMTQzOTA0MTY4M2U5YzJjMzdkMzZmNDM4ZWYwZWYyN2MwOTM4YWRjNjIyNmUwYzAzZDE2OWYyYSJ9.h-vAWjD7BFWkWIoFLfP3UQeBslRZR5-enW_w9EUZskIMCi8f47hW0CroyYHSza0mcZVQkzStuvMvOH8HBsusw1MMulVQHyVnsBUZO6CQnBrc-WRh8EhFEoVVaM0uTlsbqFeucfLGohAzzqwXmuChBQPLR9ADUUn4KE1fHT_jUpAf30x8pLr0R-fm0049q9LveZa2b-6exqGHnUbCooqxb78HU40QCHV8qdhn6jzYN9Bp5vR1K8trO3AevoFBM6FU-ne7aVbT4sv5O9PNIBWPT_3GSCEF5tOmlnvN-4vcgPBY9FiyauL0ZF1gzf0Tm89BPSn-3uLk05YlEnREjbVwlg
2020-11-24 19:17:21,802 - utils.scopes_check - DEBUG - b'{"scopes":["im & presence"],"exp":1606317170,"sub":"im_only","siss":"JJ7wyFAcNgBvEqb6AeOKxJWdenbCK1keKkHVGatzF1\\/aLbprhyhhjRkmduFDH1IJeinRCgV4D5EC1sRp2x7hteg5uIJxsmGKKiIaqKnAgb0WXoCyYBsd3YxdU2xneSsHbaBFrC8S35ItZTvjitnm9IuLORFUXiKVuCbN+siN5S3wO2LfIK6\\/7TZxYueRPdGxhOqEnH+lxM2pwEzONTXf2ZzXZmsLYepV\\/XQqLLoPo5Z2AA+Qo9lzJNdOtTZ1YPBx2Mt+pR7jUfrV4wnRhPEDq9kjtdMiUPObekIz2002J4aerrhK7h2lUI4UVfZg7eY1zOXaCPRTsPZnBllCpSYT+g==","iss":"8a55a6dd-206e-495d-a1f3-325ee141b4fb","tid":"e1245154-12d6-4a3c-b4d7-fc5a9b3a091e","ctyp":"Bearer","ccid":"C3b0affefe1439041683e9c2c37d36f438ef0ef27c0938adc6226e0c03d169f2a"}'
2020-11-24 19:17:21,802 - utils.scopes_check - DEBUG - Token issued to user im_only, with scopes ['im & presence'] is valid until Wed Nov 25 07:12:50 2020
2020-11-24 19:17:21,803 - utils.scopes_check - DEBUG - Test for user im_only passed
2020-11-24 19:17:21,919 - utils.scopes_check - DEBUG - Authorization Code for user no_service : YmM3NmY5M2QtOGI2Zi00MjhjLWEyZWItYzBiMzQxNTJkOWJh
2020-11-24 19:17:22,040 - utils.scopes_check - DEBUG - Access token for user no_service : eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjhhNTVhNmRkLTIwNmUtNDk1ZC1hMWYzLTMyNWVlMTQxYjRmYjoyZTcxZmJjODdlMjBjZGE0YjMwNGM2NzUwMzM3NWNkNDZjZWM4OTFjMTgwMDZlYzJkNzQ5OWJhNWZiMGViNmRiIn0.eyJwcml2YXRlIjoiZXlKaGJHY2lPaUprYVhJaUxDSmpkSGtpT2lKS1YxUWlMQ0psYm1NaU9pSkJNVEk0UTBKRExVaFRNalUySWl3aWEybGtJam9pT0dFMU5XRTJaR1F0TWpBMlpTMDBPVFZrTFdFeFpqTXRNekkxWldVeE5ERmlOR1ppT2pVNE9EYzNNbUpoTlRNd01XTm1aREptWXpabE1qYzJObVF6WmpoalpqbG1PR1kwWTJKaE1qRTNOVFUxWkROaU9UVm1PVFF6TXpnME4ySXhNekpsTkRraWZRLi4xblBfcVE2UmhhSTNUbGlyd3EtVV9nLnNYeTg4UHJiSExHbHhWQ3JCRkhIRFVUc1kyOUtud1NzekU4MWswanNiVklrMFZ4a2ctb1JmUkNXbGNVN2l3LW5hTGN0RDV5U0NxQ0ktWGFaU3JTeWc3QUhGeE93ZUlHeGxZc283N25JWGxMNHQ5ckRLWlZOazRYUVY3RnpwNkF6bXF5QTlCQzZORjFZTGNnUW5KaURuWkR0Nkt5dXpGaVh5WlJoM19vQXdKT0Q4U0czZVBTdk1HYXd5VGVFTmFHWmVhYjVOSjZWa0UxS1V0VHRnUW9td2YtU3o2MmpZWC1wN0REUHRVTjJBcjI2SEJXNTh0MGZ1cHRDLXNhTjRIUDdNQjY1U2Z6VEJRX1BRNjVXR29UWmlyUTVkcVlNaWF0b18zYkhZQjZ0MTc3eXJNRG84dGg0WVpaMm1ZS1NPLUlMeVhDYkNFMHp4U3FzV3ZWN1AzTDNPa2ZmV25aSjhncUpCN2h0S2JZeTRVQ0FxX0M2VFRMZWdYaVdOYlhWYWpRUXJscjBlenowNUhUYTNxcEJjZ3FoWnhOTHBGdXR3THlNQ2hqOENxNmEwV2dLMFpsRUpQeEZGNmcyYmlSbnQ2Z1gyX2FTdXRES2c0TExpWE44c00xRkdmMW5XNW5UcE1TR0RSYlF6OHNLSzVHeHhaWmp3cl8wR3VoazlaWV9FN3hVTHFDZXFVdl9wX05vYVYySHkxUnJiaHRmY3FaOFIxN0R5X0VtUDRLS0drRlNkTVhfN2JVWGxUSExwQ0d1d1FJa3Q4dUk0dC1oZmZ2aExLRmNhUWxNT09pZTJvMF9RalZYQm03M2dUeHR1SDBtelBqSW1UdFN3enk5QkU4Z0RmU0ZtN1JKVl94cTJfMU9RbllmX1dwTzlKQzZQcHRvWnd5TjVlNl9aSFlVREdpNEF3eE1TTXFDN0VrcjIwMFFGMkpwTWNPWFhxdG8zeDB1eUozcnFNMWVnWlJTWEkyQWE5anBwUlNlRF9xX1NQaXI0OVk2MUQ3TmZUUTUwZnJpM19VX0pmTEhXNDBPeTdXZ0hMRHdyT1FCMGtUMmlCRFdadDB2a25iQjRfWkVMUzQuMC1zaGZpRkowelRDdzZESWJCVldJUSJ9.V_sFNjHb-ixaAvecASHabDZrpbf5N_t6Y1fkkhbZ2aWSSu_ETefXe7knXHkvrb_dR8qtPMPzDf-WNFacV3_QfsR6gyDf0dlLnrYoD5o5gvRXksnNcmdpt3xughk5XewRg5wRPmMhPBkFrVd2Vv2AZDzwlS6KqhfV0KvshiuC0yilM2_1zLpjeKY5HEmheHPyO8eShTWH79kn10PuMnDPFO2k9PMUfb4H_21kQKEWfTzRLm0Brx6FBkKKr9-xSSopeddR2JKcXFebzCcBdjjiw3JhT3Uva5oQitTApOuMQ3d6u8gv4ye6if_3ktmCUiKg05uNkj3ApJYUfTkjZNZGsA
2020-11-24 19:17:22,040 - utils.scopes_check - DEBUG - Refresh token for user no_service : eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjhhNTVhNmRkLTIwNmUtNDk1ZC1hMWYzLTMyNWVlMTQxYjRmYjoyZTcxZmJjODdlMjBjZGE0YjMwNGM2NzUwMzM3NWNkNDZjZWM4OTFjMTgwMDZlYzJkNzQ5OWJhNWZiMGViNmRiIn0.eyJleHAiOjE2MTE0OTc1NzAsImlzcyI6IjhhNTVhNmRkLTIwNmUtNDk1ZC1hMWYzLTMyNWVlMTQxYjRmYiIsInR5cCI6InVzZXIiLCJ0aWQiOiI0NDFiOGE1MC01YzhiLTRhNjEtODQ0Yy1iNjY1YzJjZTc4N2YiLCJjdHlwIjoicmVmcmVzaCIsImNjaWQiOiJDM2IwYWZmZWZlMTQzOTA0MTY4M2U5YzJjMzdkMzZmNDM4ZWYwZWYyN2MwOTM4YWRjNjIyNmUwYzAzZDE2OWYyYSJ9.ycQ3n1Jb0CMGiU3X-t3w5tEC0rSTfMxfq5LqstyasNrVGLRbDelkTmMn22mwWfqyjWLSoD1F-dh6s9Hf-kbGXgYh5bnmxzHiei3MyOk_Q3tH2UvrR0cxmZx7OviMbkn0cSpuvmM8OQgvbiQNyxJu5KBBLtWuaarqbv2-nWjT2uerxi4DyUCFM-sg-YQkDBg1LXArbWXe2xlcsel-Ng0_ChANmtqQopBgm0QabnppQf0qyrT4XJbbCUFZL3iUAvnr2bQwpPqfm94dQd8V6Vb9euRnymWquiswdz6X05ibrDrxYfAvOncsSviP0RFznHVMlRy1LCWbre-xV4qGYwPs6Q
2020-11-24 19:17:22,043 - utils.scopes_check - DEBUG - b'{"scopes":["no service"],"exp":1606317170,"sub":"no_service","siss":"JJ7wyFAcNgBvEqb6AeOKxJWdenbCK1keKkHVGatzF1\\/aLbprhyhhjRkmduFDH1IJeinRCgV4D5EC1sRp2x7hteg5uIJxsmGKKiIaqKnAgb0WXoCyYBsd3YxdU2xneSsHbaBFrC8S35ItZTvjitnm9IuLORFUXiKVuCbN+siN5S3wO2LfIK6\\/7TZxYueRPdGxhOqEnH+lxM2pwEzONTXf2ZzXZmsLYepV\\/XQqLLoPo5Z2AA+Qo9lzJNdOtTZ1YPBx2Mt+pR7jUfrV4wnRhPEDq9kjtdMiUPObekIz2002J4aerrhK7h2lUI4UVfZg7eY1zOXaCPRTsPZnBllCpSYT+g==","iss":"8a55a6dd-206e-495d-a1f3-325ee141b4fb","tid":"327f1af4-70ef-45bd-990b-261e536d01a7","ctyp":"Bearer","ccid":"C3b0affefe1439041683e9c2c37d36f438ef0ef27c0938adc6226e0c03d169f2a"}'
2020-11-24 19:17:22,043 - utils.scopes_check - DEBUG - Token issued to user no_service, with scopes ['no service'] is valid until Wed Nov 25 07:12:50 2020
2020-11-24 19:17:22,043 - utils.scopes_check - DEBUG - Test for user no_service passed
2020-11-24 19:17:24,546 - utils.utility - DEBUG - Test TearDown: User full_scope removed successfully
2020-11-24 19:17:26,563 - utils.utility - DEBUG - Test TearDown: Profile full_scope removed successfully
2020-11-24 19:17:28,600 - utils.utility - DEBUG - Test TearDown: User im_only removed successfully
2020-11-24 19:17:30,533 - utils.utility - DEBUG - Test TearDown: Profile im_only removed successfully
2020-11-24 19:17:32,564 - utils.utility - DEBUG - Test TearDown: User no_service removed successfully
2020-11-24 19:17:34,587 - utils.utility - DEBUG - Test TearDown: Profile no_service removed successfully
2020-11-24 19:17:34,587 - utils.utility - DEBUG - All users and profiles removed succesfully
2020-11-24 19:17:36,624 - utils.utility - DEBUG - Test TearDown: User neo0 removed successfully
```
